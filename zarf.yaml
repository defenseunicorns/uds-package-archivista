# Copyright 2024 Defense Unicorns
# SPDX-License-Identifier: AGPL-3.0-or-later OR LicenseRef-Defense-Unicorns-Commercial

# yaml-language-server: $schema=https://raw.githubusercontent.com/defenseunicorns/zarf/main/zarf.schema.json
kind: ZarfPackageConfig
metadata:
  name: archivista
  description: "A deployment of Archivista, an application for storing in-toto attestations."
  version: "dev"
  annotations:
    title: Archivista
    description: Archivista is a graph and storage service for in-toto attestations, enabling the discovery, retrieval, and querying of software artifact attestations. It provides a centralized, trusted store for supply chain metadata, allowing users to store, retrieve, and query relationships between attestations via a GraphQL API. Archivista enhances software supply chain security by creating a queryable graph of metadata while storing signed attestations, supporting policy validation without manual listing of expected attestations. Archivista integrates seamlessly with major cloud service providers and supports various architectures (Darwin, Windows, ARM), making it a versatile solution for securing software supply chains across different environments.
    categories: Security,Software Dev,IT Management,Databases
    keywords: Supply Chain Security,Software Attestations,GraphQL API,Cloud Integration,Software Metadata,Policy Validation,In-Toto Attestations,Cross-Platform Support

variables:
  - name: DB_PASSWORD
    description: "Database Password for Archivista"
  - name: ACCESS_KEY
    description: "Access Key for S3 compatible storage"
  - name: SECRET_KEY
    description: "Secret Key for S3 compatible storage"

components:
  - name: archivista
    required: true
    description: "Deploy Archivista"
    import:
      path: common
    only:
      flavor: upstream
    charts:
      - name: archivista
        valuesFiles:
          - values/upstream-values.yaml
    images:
      - ghcr.io/in-toto/archivista:0.9.0

  - name: archivista
    required: true
    description: "Deploy Archivista"
    import:
      path: common
    only:
      flavor: unicorn
    charts:
      - name: archivista
        valuesFiles:
          - values/unicorn-values.yaml
    images:
      - ghcr.io/in-toto/archivista:0.9.0
